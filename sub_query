1. List the product that have min (not null) quantities ordered in one order.

SELECT DISTINCT p.product_id, p.product_name, oi.quantity
FROM order_items oi
JOIN products p ON p.product_id = oi.product_id
WHERE oi.quantity = (SELECT MIN(quantity) FROM order_items);

2. List the name and quantity of the inventory product with maximum quantity (excluding nulls).

SELECT p.product_id, p.product_name, i.quantity
FROM inventories i 
JOIN products p
    ON p.product_id = i.product_id
    WHERE i.quantity = (
        SELECT MAX(quantity)
        FROM inventories 
        WHERE quantity IS NOT NULL
    );


3. List the countries with minimum numbers of locations (not nulls)
--result should be show list of countreis(id, name) and min num of loccations
SELECT countries.country_id,
       countries.country_name,
       per_country_loc_counts.location_count
FROM (
    SELECT country_id,
           COUNT(*) AS location_count
    FROM   locations
    WHERE  country_id IS NOT NULL
    GROUP  BY country_id 
) per_country_loc_counts
JOIN countries
  ON countries.country_id = per_country_loc_counts.country_id
WHERE per_country_loc_counts.location_count = (
    SELECT MIN(m.location_count)
    FROM (
        SELECT country_id,
               COUNT(*) AS location_count
        FROM   locations
        WHERE  country_id IS NOT NULL
        GROUP  BY country_id
    ) m
);

4. List the salesman(s) with minimum (not null) number of orders.
-- table ORDERS have order_id, salesaman_id count(*) cnt and MIN()
-- have to show
SELECT e.employee_id, e.first_name, e.last_name
FROM employees e
WHERE ( 
    SELECT COUNT(*)
    FROM orders o
    WHERE o.salesman_id = e.employee_id
) = (
    SELECT MIN(
        (SELECT COUNT(*)
        FROM orders o2
        WHERE o2.salesman_id = o2.employee_id
        )
    )
    FROM employees o2
);

5. List the customer(s) with min number of orders (not nulls).
-- table CUSTOMERS customer_id name table ORDERS have customer_id
SELECT c.customer_id, c.name
FROM customers c
WHERE (
    SELECT COUNT(*)
    FROM orders o
    WHERE o.customer_id = c.customer_id
) = (
    SELECT MIN(
        (SELECT COUNT(*)
         FROM orders o2
         WHERE o2.customer_id = customer_id
        )
    )
    FROM customer c2
);